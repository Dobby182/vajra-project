<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>All Products - Vajra Naturals</title>

  <link rel="icon" type="image/png" sizes="32x32" href="images/vajralogo.png" />

  <!-- Google Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link
    href="https://fonts.googleapis.com/css2?family=Libre+Baskerville:wght@400;600&family=Montserrat:wght@300;400;500;600&family=Playfair+Display:wght@500;600;700&display=swap"
    rel="stylesheet" />

  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />

  <!-- Main CSS -->
  <link rel="stylesheet" href="css/style.css" />
</head>

<body>
  <div class="top-banner">Get extra 10% off on your first order</div>

  <script src="/js/site.js"></script>

  <!-- Navbar -->
  <header>
    <nav class="navbar">
      <div class="navbar-left">
        <h1 class="playfair-font">vajra</h1>

        <div class="nav-links">
          <a href="index.html">HOME</a>
          <a href="products.html" class="active">PRODUCTS</a>

          <div class="dropdown">
            <a href="#">CATEGORIES</a>
            <div class="dropdown-content">
              <a href="/category/hair.html">HAIR</a>
              <a href="/category/skin.html">SKIN</a>
              <a href="/category/food.html">FOOD</a>
            </div>
          </div>

          <a href="reviews.html">REVIEWS</a>
          <a href="contact.html">CONTACT</a>
        </div>
      </div>

      <div class="navbar-right-group">
        <form class="search-bar">
          <i class="fa fa-search"></i>
          <input type="text" required />
        </form>

        <div class="navbar-icons">
          <a href="wishlist.html"><i class="far fa-heart"></i></a>
          <a href="cart.html"><i class="fas fa-shopping-cart"></i></a>
          <a href="login.html"><i class="far fa-user-circle"></i></a>
        </div>
      </div>
    </nav>
  </header>

  <h2 class="category-title">All Products</h2>

  <div class="category-container">
    <!-- -------------------------
          HAIR CARE
    --------------------------- -->
    <div class="category-card">
      <img src="images/hairoil.png" alt="Herbal Hair Oil" />
      <h3>Herbal Hair Oil</h3>
      <div class="ratings">‚≠ê‚≠ê‚≠ê‚≠ê‚òÜ (4.5/5)</div>
      <p>‚Çπ350 <span class="old-price">‚Çπ400</span></p>

      <div class="quantity-selector">
        <button class="decrease">-</button>
        <input type="number" value="1" min="1" />
        <button class="increase">+</button>
      </div>

      <div class="actions">
        <button class="add-to-cart">Add to Cart</button>
        <button class="like-btn">ü§ç</button>
      </div>
    </div>

    <!-- Herbal Shampoo (updated) -->
    <div class="category-card">
      <img src="images/hibiscushampoo.jpeg" alt="Hibiscus Shampoo" />
      <h3>Herbal Shampoo</h3>
      <div class="ratings">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê (5/5)</div>
      <p>‚Çπ300 <span class="old-price">‚Çπ350</span></p>

      <div class="quantity-selector">
        <button class="decrease">-</button>
        <input type="number" value="1" min="1" />
        <button class="increase">+</button>
      </div>

      <div class="actions">
        <button class="add-to-cart">Add to Cart</button>
        <button class="like-btn">ü§ç</button>
      </div>
    </div>

    <!-- -------------------------
          SKIN CARE (New Items)
    --------------------------- -->

    <div class="category-card">
      <img src="images/rice water face wash.jpeg" alt="Rice Water Face Wash" />
      <h3>Rice Water Face Wash</h3>
      <div class="ratings">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê (5/5)</div>
      <p>‚Çπ280 <span class="old-price">‚Çπ320</span></p>

      <div class="quantity-selector">
        <button class="decrease">-</button>
        <input type="number" value="1" min="1" />
        <button class="increase">+</button>
      </div>

      <div class="actions">
        <button class="add-to-cart">Add to Cart</button>
        <button class="like-btn">ü§ç</button>
      </div>
    </div>

    <div class="category-card">
      <img src="images/orangepeelpowder.jpeg" alt="Orange Peel Powder" />
      <h3>Orange Peel Powder</h3>
      <div class="ratings">‚≠ê‚≠ê‚≠ê‚≠ê‚òÜ (4.5/5)</div>
      <p>‚Çπ200 <span class="old-price">‚Çπ250</span></p>

      <div class="quantity-selector">
        <button class="decrease">-</button>
        <input type="number" value="1" min="1" />
        <button class="increase">+</button>
      </div>

      <div class="actions">
        <button class="add-to-cart">Add to Cart</button>
        <button class="like-btn">ü§ç</button>
      </div>
    </div>

    <div class="category-card">
      <img src="images/herbalbathpowder.jpeg" alt="Herbal Bath Powder" />
      <h3>Herbal Bath Powder</h3>
      <div class="ratings">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê (5/5)</div>
      <p>‚Çπ260 <span class="old-price">‚Çπ300</span></p>

      <div class="quantity-selector">
        <button class="decrease">-</button>
        <input type="number" value="1" min="1" />
        <button class="increase">+</button>
      </div>

      <div class="actions">
        <button class="add-to-cart">Add to Cart</button>
        <button class="like-btn">ü§ç</button>
      </div>
    </div>

    <div class="category-card">
      <img src="images/aloeveragel.jpeg" alt="Aloe Vera Gel" />
      <h3>Aloe Vera Gel</h3>
      <div class="ratings">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê (5/5)</div>
      <p>‚Çπ220 <span class="old-price">‚Çπ260</span></p>

      <div class="quantity-selector">
        <button class="decrease">-</button>
        <input type="number" value="1" min="1" />
        <button class="increase">+</button>
      </div>

      <div class="actions">
        <button class="add-to-cart">Add to Cart</button>
        <button class="like-btn">ü§ç</button>
      </div>
    </div>

    <div class="category-card">
      <img src="images/aloverasaop.jpeg" alt="Aloe Vera Soap" />
      <h3>Aloe Vera Soap</h3>
      <div class="ratings">‚≠ê‚≠ê‚≠ê‚≠ê‚òÜ (4.5/5)</div>
      <p>‚Çπ120 <span class="old-price">‚Çπ150</span></p>

      <div class="quantity-selector">
        <button class="decrease">-</button>
        <input type="number" value="1" min="1" />
        <button class="increase">+</button>
      </div>

      <div class="actions">
        <button class="add-to-cart">Add to Cart</button>
        <button class="like-btn">ü§ç</button>
      </div>
    </div>

    <div class="category-card">
      <img src="images/turmericsoap.jpeg" alt="Turmeric Soap" />
      <h3>Turmeric Soap</h3>
      <div class="ratings">‚≠ê‚≠ê‚≠ê‚≠ê‚òÜ (4/5)</div>
      <p>‚Çπ130 <span class="old-price">‚Çπ160</span></p>

      <div class="quantity-selector">
        <button class="decrease">-</button>
        <input type="number" value="1" min="1" />
        <button class="increase">+</button>
      </div>

      <div class="actions">
        <button class="add-to-cart">Add to Cart</button>
        <button class="like-btn">ü§ç</button>
      </div>
    </div>

    <div class="category-card">
      <img src="images/charcoalsoap.jpeg" alt="Charcoal Soap" />
      <h3>Charcoal Soap</h3>
      <div class="ratings">‚≠ê‚≠ê‚≠ê‚≠ê‚òÜ (4.5/5)</div>
      <p>‚Çπ140 <span class="old-price">‚Çπ180</span></p>

      <div class="quantity-selector">
        <button class="decrease">-</button>
        <input type="number" value="1" min="1" />
        <button class="increase">+</button>
      </div>

      <div class="actions">
        <button class="add-to-cart">Add to Cart</button>
        <button class="like-btn">ü§ç</button>
      </div>
    </div>

    <div class="category-card">
      <img src="images/rosesoap.jpeg" alt="Rose Petal Soap" />
      <h3>Rose Petal Soap</h3>
      <div class="ratings">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê (5/5)</div>
      <p>‚Çπ150 <span class="old-price">‚Çπ190</span></p>

      <div class="quantity-selector">
        <button class="decrease">-</button>
        <input type="number" value="1" min="1" />
        <button class="increase">+</button>
      </div>

      <div class="actions">
        <button class="add-to-cart">Add to Cart</button>
        <button class="like-btn">ü§ç</button>
      </div>
    </div>

    <!-- -------------------------
          FOOD ITEMS (New)
    --------------------------- -->

    <div class="category-card">
      <img src="/images/health mix powder .jpeg" alt="Health Mix" />
      <h3>Health Mix</h3>
      <div class="ratings">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê (5/5)</div>
      <p>‚Çπ250 <span class="old-price">‚Çπ300</span></p>

      <div class="quantity-selector">
        <button class="decrease">-</button>
        <input type="number" value="1" min="1" />
        <button class="increase">+</button>
      </div>

      <div class="actions">
        <button class="add-to-cart">Add to Cart</button>
        <button class="like-btn">ü§ç</button>
      </div>
    </div>

    <div class="category-card">
      <img src="/images/wegiht loss.jpeg" alt="Weight Loss Powder" />
      <h3>Weight Loss Powder</h3>
      <div class="ratings">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê (5/5)</div>
      <p>‚Çπ300 <span class="old-price">‚Çπ350</span></p>

      <div class="quantity-selector">
        <button class="decrease">-</button>
        <input type="number" value="1" min="1" />
        <button class="increase">+</button>
      </div>

      <div class="actions">
        <button class="add-to-cart">Add to Cart</button>
        <button class="like-btn">ü§ç</button>
      </div>
    </div>

    <div class="category-card">
      <img src="images/idlypodi.jpeg" alt="Idly Podi" />
      <h3>Idly Podi</h3>
      <div class="ratings">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê (5/5)</div>
      <p>‚Çπ180 <span class="old-price">‚Çπ220</span></p>

      <div class="quantity-selector">
        <button class="decrease">-</button>
        <input type="number" value="1" min="1" />
        <button class="increase">+</button>
      </div>

      <div class="actions">
        <button class="add-to-cart">Add to Cart</button>
        <button class="like-btn">ü§ç</button>
      </div>
    </div>
  </div>

  <div class="no-results" id="no-results">No products found</div>
  <script>
    // Quantity buttons + per-browser like toggle (consolidated to 'liked' array)
    let likedList = window.__site.getLiked();

    document.querySelectorAll(".category-card").forEach((card) => {
      // Quantity controls
      const input = card.querySelector("input");
      card
        .querySelector(".increase")
        .addEventListener(
          "click",
          () => (input.value = parseInt(input.value) + 1)
        );
      card.querySelector(".decrease").addEventListener("click", () => {
        if (input.value > 1) input.value = parseInt(input.value) - 1;
      });

      // Identify product by name (use innerText of h3)
      const name = card.querySelector("h3").textContent.trim();

      // Like button (per-browser state only) - use consolidated liked array
      const likeBtn = card.querySelector(".like-btn");
      const idxInit = likedList.findIndex((i) => i.name === name);
      likeBtn.textContent = idxInit !== -1 ? "‚ù§Ô∏è" : "ü§ç";
      likeBtn.classList.toggle("liked", idxInit !== -1);

      likeBtn.addEventListener("click", () => {
        // Build minimal product info
        const img = card.querySelector("img")?.getAttribute("src") || "";
        const pEl = card.querySelector("p");
        let price = 0;
        if (pEl) {
          const firstText = pEl.childNodes[0]?.textContent || "";
          price = parseInt(firstText.replace(/[^0-9]/g, "").trim()) || 0;
        }
        const oldPrice =
          card
            .querySelector(".old-price")
            ?.textContent.replace(/[^0-9]/g, "") || "";

        const product = { name, price, oldPrice, img };
        likedList = window.__site.toggleLiked(product);
        const nowLiked = likedList.findIndex((i) => i.name === name) !== -1;
        likeBtn.textContent = nowLiked ? "‚ù§Ô∏è" : "ü§ç";
        likeBtn.classList.toggle("liked", nowLiked);
      });
    });

    // Cart logic (unchanged)
    let cart = JSON.parse(localStorage.getItem("cart")) || [];

    document.querySelectorAll(".category-card").forEach((card) => {
      const addBtn = card.querySelector(".add-to-cart");

      addBtn.addEventListener("click", () => {
        const name = card.querySelector("h3").textContent;
        // extract only the main price (before the .old-price span)
        const pElCart = card.querySelector("p");
        let price = 0;
        if (pElCart) {
          const firstText = pElCart.childNodes[0]?.textContent || "";
          price = parseInt(firstText.replace(/[^0-9]/g, "").trim()) || 0;
        }
        const oldPrice =
          card
            .querySelector(".old-price")
            ?.textContent.replace(/[^0-9]/g, "") || "0";
        // normalize image path so it works from any page
        const imgAttr = card.querySelector("img")?.getAttribute("src") || "";
        const img = window.__site.normalizeImg(imgAttr);
        const quantity = parseInt(card.querySelector("input").value);
        const ratings = card.querySelector(".ratings")?.textContent || "";

        let existing = cart.find((item) => item.name === name);

        if (existing) {
          existing.quantity += quantity;
        } else {
          cart.push({
            name: name,
            price: price,
            oldPrice: oldPrice,
            img: img,
            quantity: quantity,
            ratings: ratings,
          });
        }

        localStorage.setItem("cart", JSON.stringify(cart));
        alert("Added to Cart!");
      });
    });

    // --- Search wiring: call shared search helper on input or submit ---
    const searchForm = document.querySelector(".search-bar");
    if (searchForm) {
      const searchInput = searchForm.querySelector("input");
      const noResultsEl = document.getElementById("no-results");

      function runSearchAndShow(q) {
        const visible = window.__site.searchProducts(
          q,
          ".category-container"
        );
        if (noResultsEl) noResultsEl.classList.toggle("show", visible === 0);
      }

      searchForm.addEventListener("submit", (e) => {
        e.preventDefault();
        const q = (searchInput.value || "").trim();
        runSearchAndShow(q);
      });

      searchInput.addEventListener("input", (e) => {
        runSearchAndShow(e.target.value || "");
      });

      // clicking the search icon focuses the input
      const icon = searchForm.querySelector("i");
      if (icon) icon.addEventListener("click", () => searchInput.focus());
    }

    // If a query param `q` is present, run that search on load and set input
    (function runQueryFromUrl() {
      try {
        const params = new URLSearchParams(window.location.search);
        const q = params.get("q");
        if (q) {
          const searchForm = document.querySelector(".search-bar");
          const searchInput = searchForm?.querySelector("input");
          if (searchInput) searchInput.value = q;
          // use the same runSearchAndShow helper if available
          if (typeof runSearchAndShow === "function") {
            runSearchAndShow(q);
          } else if (window.__site && window.__site.searchProducts) {
            const visible = window.__site.searchProducts(
              q,
              ".category-container"
            );
            const noResultsEl = document.getElementById("no-results");
            if (noResultsEl)
              noResultsEl.classList.toggle("show", visible === 0);
          }
        }
      } catch (err) {
        console.warn("Failed to run query from URL", err);
      }
    })();
  </script>

  <footer class="site-footer">¬© VAJRA NATURALS</footer>
</body>

</html>